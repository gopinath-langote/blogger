webpackJsonp([3],{0:function(e,n,t){var r,a=t(1);t(1),r=a.module("design",[t(25),t(109),t(75),t(82),t(26),t(32),t(81),t(80),t(3),t(127)]),r.config(["$locationProvider",function(e){return e.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}]),r.directive("addDesignToBasket",["CustomerBasket",function(e){return{transclude:!0,replace:!0,template:"<span ng-transclude></span>",restrict:"A",scope:{addDesignToBasket:"@",addDesignToBasketMinimumQuantity:"@"},link:function(n,t,r){var a,i,o;return i=parseInt(n.addDesignToBasketMinimumQuantity,10),o=function(){return e.redirectToBasket()},a=function(){return t.removeClass("disabled")},t.bind("click",function(){return t.addClass("disabled"),n.$apply(function(){return e.addDesignByPath(n.addDesignToBasket,i).then(o,a)}),!1})}}}]),r.directive("addProductToCurrentJob",["CustomerBasket",function(e){return{transclude:!0,replace:!0,template:"<span ng-transclude></span>",restrict:"A",scope:{choiceDocument:"=",listingImage:"=",productPath:"=",avoidChannelPrices:"="},link:function(n,t,r){var a,i,o,s,d;return a=null,o=null,s=null,n.$watch("choiceDocument",function(e){return a=e}),n.$watch("listingImage",function(e){return o=e}),n.$watch("productPath",function(e){return s=e}),d=function(){return e.redirectToBasket()},i=function(){return t.removeClass("disabled")},t.bind("click",function(){return t.addClass("disabled"),n.$apply(function(){var t;return t=e.addProduct(s,a,o,n.avoidChannelPrices),t.then(d,i)}),!1})}}}]),r.directive("designStatsView",["MarketplaceApi",function(e){return{transclude:!0,template:'<div ng-if="ready()"></div>',scope:{designStatsView:"@"},controller:["$scope","$element","$transclude","linkService","$filter",function(n,t,r,i,o){var s;return n.stats={},s=!1,n.ready=function(){return s},n.pinLink=i.pin,e.design.stats(n.designStatsView).then(function(e){return s=!0,a.extend(n.stats,e.original),n.stats.download_count_formatted=o("number")(n.stats.download_count,0),r(n,function(e,n){return t.append(e)})})}]}}]),r.directive("designLocalisedPrice",function(){return{template:"{{ localisedPrice }}",scope:{basePrice:"=",baseCurrency:"@"},controller:["$scope","locationService","Session","$window",function(e,n,t,r){var a,i;return a=function(e,t){return n.displayPrice(e,t,0)},e.localisedPrice=a(e.basePrice,e.baseCurrency),i=function(n){return t.localizeCurrency(n,e.baseCurrency).then(function(n,t){return e.localisedPrice=a(n,t)})},e.basePrice&&i(e.basePrice),e.$on("design-localised-price:base-price-change",function(e,n){return i(n)})}]}}),t(73)(),e.exports=r.name},127:function(e,n,t){var r,a=t(1);r=a.module("design.download",[t(4),t(52),t(26),t(84),t(50),t(24)]),r.directive("opendeskDownloadDesign",["$location","formService","Price",function(e,n,r){return{restrict:"A",transclude:!0,scope:{design:"@",basePrice:"=",baseCurrency:"@",stripeImage:"@",stripeName:"@",stripeDescription:"@"},template:t(128),link:function(e,n,t,a,i){return e.$on("$destroy",e.$watch("expanded",function(t){return t?$(n).find(e.focus_selector).focus():void 0})),i(function(t,a){return a.downloadPrice=new r({taxed_total:e.basePrice,currency:e.baseCurrency}),t.find("[expand-download]").on("click",function(n){return n.preventDefault(),e.expand(),!1}),n.find("[insert-expand-button]").append(t)})},controller:["$scope","locationService","Session","MarketplaceApi","userService","linkService",function(e,t,i,o,s,d){return e.expanded=!1,e.download_data={},e.$on("$destroy",e.$watch("user",function(n){return null!=n&&n.id?(e.download_data.user_name=n.name,e.download_data.user_email=n.email,e.focus_selector="textarea[name=description]"):(e.download_data.user_name=null,e.download_data.user_email=null,e.focus_selector="input[name=name]"),e.submitted=!1})),e.expand=function(){return s.identify().then(function(n){return e.user=n,e.expanded=!0})},e.contract=function(){return e.expanded=!1},e.toggle_terms=function(){return e.download_data.agree_terms=!e.download_data.agree_terms},e.downloadPrice=new r({taxed_total:e.basePrice,currency:e.baseCurrency}),e.download=function(){return o.lookupDesignByPath(e.design).then(function(r){return function(r){return t.locate().then(function(t){var i,s,c;return i=a.extend({},e.download_data,{design_id:r.id,lat:t.lat,lng:t.lng,address:t.display_name}),s=function(t){return function(r){return n.displayErrors(t,r.data.errors),e.in_progress=!1}}(this),c=function(n){return e.submitted=!0,e.in_progress=!1,d.href(d.useUrl(e.design,n.id,"download"))},o.createUse(i).then(c,s),e.in_progress=!0,!1})}}(this))}}]}}]),e.exports=r.name},128:function(e,n){var t='<div ng-controller="AuthController"> <div class="make-actions-tmpl checkout-actions" images-loaded-selector="#design-strap-image"> <div class="checkout-action checkout-action-primary"> <div ng-hide="expanded"> <div class="checkout-action-button" insert-expand-button> </div> </div> <div ng-show="expanded"> <form name="download_form" role="form" class="checkout-action-form" stripe-name="{{ stripeName }}" stripe-description="{{ stripeDescription }} for {{ localisedPrice }}" stripe-image="stripeImage" stripe-cents="basePrice * 100" stripe-currency="baseCurrency" stripe-token-model="download_data.stripe_token_json_str" stripe-submit="download" stripe-payment-form> <input type="hidden" name="stripe_token_json_str" ng-model="download_data.stripe_token_json_str"/> <div ng-hide="submitted"> <div class="row" ng-hide="user && user.username"> <div form-group class-name="col-sm-12 form-group" label="Your name:"> <input type="text" name="name" class="form-control" placeholder="Firstname Lastname" ng-model="download_data.user_name" pick-up-auto-fill required/> </div> <div form-group class-name="col-sm-12 form-group" label="Email:"> <input type="email" name="email" class="form-control" placeholder="you@domain.com" ng-model="download_data.user_email" pick-up-auto-fill required/> </div> </div> <div form-group class-name="form-group" label="What will you use the {{ design.name }} for?"> <textarea name="description" class="form-control" ng-model="download_data.description" required/>\n            </div>\n            <div form-group class-name="form-group clearfix">\n              <input type="checkbox" name="agree_terms" ng-model="download_data.agree_terms" ng-required="download_data.agree_terms===false" style="float: left"/>\n              <label class="error-aware" style="display: block; padding-top: 1px">\n                <span ng-click="toggle_terms()" class="no-visual">\n                  &nbsp; I accept the terms of the</span>\n                <a ng-href="{{ design.license.url }}" target="_blank">\n                  {{ design.license.acronym }} license</a>\n                <span ng-click="toggle_terms()" class="no-visual">\n                  and the Opendesk</span>\n                <a href="/privacy" target="_blank">\n                  privacy policy</a>.\n              </label>\n            </div>\n            <div class="form-actions">\n              <button type="submit" class="btn btn-lg btn-block btn-primary" ng-disabled="download_form.$invalid || !download_data.agree_terms">\n                  <span ng-class="{\'loading-indicator\': true, disabled: in_progress}">\n                    Download for <span localised-price price="downloadPrice" display="includingTax"></span> &raquo;\n                  </span>\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n</div></div>';window.angular.module(["ng"]).run(["$templateCache",function(e){e.put("apps/design/download/download.tpl.html",t)}]),e.exports=t}});